
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../get_started/">
      
      
        <link rel="next" href="../registry/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.30">
    
    
      
        <title>Abstract Factory - objectory</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#abstract-factory" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="objectory" class="md-header__button md-logo" aria-label="objectory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            objectory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Abstract Factory
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/durandtibo/objectory" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    durandtibo/objectory
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../get_started/" class="md-tabs__link">
        
  
    
  
  Get Started

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../refs/" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/durandtibo/objectory" class="md-tabs__link">
        
  
    
  
  GitHub

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="objectory" class="md-nav__button md-logo" aria-label="objectory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    objectory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/durandtibo/objectory" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    durandtibo/objectory
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../get_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Abstract Factory
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Abstract Factory
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-a-factory" class="md-nav__link">
    <span class="md-ellipsis">
      Create a factory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#register-an-object" class="md-nav__link">
    <span class="md-ellipsis">
      Register an object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Register an object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_object-function" class="md-nav__link">
    <span class="md-ellipsis">
      register_object function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registered-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Registered objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Registered objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inheritors" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Missing objects
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#factory" class="md-nav__link">
    <span class="md-ellipsis">
      Factory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Factory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-object" class="md-nav__link">
    <span class="md-ellipsis">
      Target object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialization-function" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instantiate-an-unregistered-object" class="md-nav__link">
    <span class="md-ellipsis">
      Instantiate an unregistered object
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#register-all-the-child-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Register all the child classes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Error messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../name_resolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Name Resolution Mechanism
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../refs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main classes and functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../refs/abstract_factory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abstract factory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../refs/registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../refs/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/durandtibo/objectory" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-a-factory" class="md-nav__link">
    <span class="md-ellipsis">
      Create a factory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#register-an-object" class="md-nav__link">
    <span class="md-ellipsis">
      Register an object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Register an object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_object-function" class="md-nav__link">
    <span class="md-ellipsis">
      register_object function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registered-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Registered objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Registered objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inheritors" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Missing objects
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#factory" class="md-nav__link">
    <span class="md-ellipsis">
      Factory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Factory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-object" class="md-nav__link">
    <span class="md-ellipsis">
      Target object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialization-function" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instantiate-an-unregistered-object" class="md-nav__link">
    <span class="md-ellipsis">
      Instantiate an unregistered object
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#register-all-the-child-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Register all the child classes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Error messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="abstract-factory">Abstract Factory<a class="headerlink" href="#abstract-factory" title="Permanent link">&para;</a></h1>
<p>This page presents the <code>AbstractFactory</code> metaclass which implement an
<a href="https://refactoring.guru/design-patterns/abstract-factory">abstract factory</a> design pattern.
The abstract factory is a creational design pattern that lets you produce families of related
objects without specifying their concrete classes.
This design pattern is also known as "Factory of Factories" because it is a "super-factory" which
creates other factories.
This metaclass proposes an implementation for creating a factory of related objects without
explicitly specifying their classes.
Each generated factory can instantiate the objects as per the Factory pattern.</p>
<h2 id="create-a-factory">Create a factory<a class="headerlink" href="#create-a-factory" title="Permanent link">&para;</a></h2>
<p>The <code>AbstractFactory</code> metaclass is not a factory, but it contains the blueprint on how to build a
factory.
To create a factory, you will define a base class.
This class is used to register the other classes but also to define the common interface of the
factory.
In the following of the documentation, we will call this class the base factory class.
The example below shows the minimal implementation of a base class:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">objectory</span> <span class="kn">import</span> <span class="n">AbstractFactory</span>


<span class="k">class</span> <span class="nc">BaseClass</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">AbstractFactory</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>
<p>The base class should inherit the <code>AbstractFactory</code> metaclass.
This metaclass will implement the factory mechanism to the base class.
The base class can implement functions and attributes like a regular python class.
It can also be an abstract class or not.</p>
<h2 id="register-an-object">Register an object<a class="headerlink" href="#register-an-object" title="Permanent link">&para;</a></h2>
<p>This section explains the basics on how to register an object to a factory.
It is possible to register a function.
This section assumes you already created a factory as explained above.
There are two approaches to register an object to the factory:</p>
<ul>
<li>by using the inheritance (only for class)</li>
<li>by using the <code>register_object</code> function (both class and function)</li>
</ul>
<h3 id="inheritance">Inheritance<a class="headerlink" href="#inheritance" title="Permanent link">&para;</a></h3>
<p>The recommended approach to register a class to the factory is to use the inheritance.
Every time that you create a new child class of the base factory class, the child class is
automatically registered to the factory.
For example, you can define the <code>Child1Class</code> class with the following implementation:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">objectory</span> <span class="kn">import</span> <span class="n">AbstractFactory</span>


<span class="k">class</span> <span class="nc">BaseClass</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">AbstractFactory</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">Child1Class</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>
<p>When the <code>Child1Class</code> class is created, it is automatically added to the <code>BaseClass</code> factory.
The developer does not have to write any additional line to register the class.
It is possible to define more complex child classes with a constructor or any functions/attributes.
For example, you can define the <code>Child2Class</code> class with the following implementation:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Child2Class</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>
</code></pre></div>
<p>Similarly, any grand child class of the base factory class is automatically registered to the
factory.
In the following example, the <code>Child3Class</code> class which inherits from <code>Child1Class</code> class will be
added to the <code>BaseClass</code> factory:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Child3Class</span><span class="p">(</span><span class="n">Child1Class</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>
<h3 id="register_object-function"><code>register_object</code> function<a class="headerlink" href="#register_object-function" title="Permanent link">&para;</a></h3>
<p>The inheritance approach works when it is possible to modify the source code of the classes because
each registered need to inherit from the base factory class.
However, it is not possible to do that in particular when the code depends on a third party library.
To overcome this limitation, it is possible to use the <code>register_object</code> function to manually
register some classes that are defined outside the project.</p>
<p>Let's take the example of <a href="https://pytorch.org/">PyTorch</a>.
PyTorch is an open source machine learning framework.
To define a machine learning model in PyTorch, you can implement a new class that inherits from
the <code>torch.nn.Module</code> class.
PyTorch also provides many module implementations.
If you want to build a factory that includes both your module implementations and the PyTorch ones,
you can do it by using the inheritance and the <code>register_object</code> function.
First, you need to define the base factory class:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">objectory</span> <span class="kn">import</span> <span class="n">AbstractFactory</span>


<span class="k">class</span> <span class="nc">BaseModule</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">AbstractFactory</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">MyModule1</span><span class="p">(</span><span class="n">BaseModule</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">MyModule2</span><span class="p">(</span><span class="n">BaseModule</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>
<p>Then you can register some modules implemented in PyTorch.
For example if you want to register the class <code>torch.nn.Linear</code> to the factory of <code>BaseModule</code>, you
can write the following lines:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">BaseModule</span><span class="o">.</span><span class="n">register_object</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">)</span>
</code></pre></div>
<p>The <code>register_object</code> function can be used to register a class but also a function.
To be consistent with the factory idea, you should <strong>only register functions that returns an object
that is compatible with the common interface of the factory</strong>.
Note that no warning will be raised if you do not follow this rule, but it will be your
responsibility to manage this situation.
Please keep in mind that <strong>with power comes responsibility</strong>.
The following example shows how to register a function:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>


<span class="k">def</span> <span class="nf">my_nodule</span><span class="p">(</span><span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">output_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">output_size</span><span class="p">),</span>
    <span class="p">)</span>


<span class="n">BaseModule</span><span class="o">.</span><span class="n">register_object</span><span class="p">(</span><span class="n">my_nodule</span><span class="p">)</span>
</code></pre></div>
<p>Another approach to register a function is to use the decorator <code>register</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">objectory</span> <span class="kn">import</span> <span class="n">register</span>


<span class="nd">@register</span><span class="p">(</span><span class="n">BaseModule</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_nodule</span><span class="p">(</span><span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">output_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">output_size</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
<p>The argument of the decorator is the base factory class where the function will be registered.</p>
<p><img alt="âš " class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/26a0.svg" title=":warning:" /> It is not possible to register a lambda function.
Please use a regular python function instead.
The registry will raise the exception <code>IncorrectObjectFactoryError</code> if you try to register a lambda
function.</p>
<h2 id="registered-objects">Registered objects<a class="headerlink" href="#registered-objects" title="Permanent link">&para;</a></h2>
<h3 id="inheritors">Inheritors<a class="headerlink" href="#inheritors" title="Permanent link">&para;</a></h3>
<p>Sometimes it is important to know what are the registered objects to the factory.
You can see the list of the objects that are registered to the base class by using the
attribute <code>inheritors</code>.
This attribute contains the full name of the class as well as the class.
If you print the value of <code>inheritors</code>,</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">BaseClass</span><span class="o">.</span><span class="n">inheritors</span><span class="p">)</span>
</code></pre></div>
<p><em>Output:</em></p>
<div class="highlight"><pre><span></span><code>{
  &quot;my_package.base.BaseClass&quot;: &lt;class &quot;my_package.base.BaseClass&quot;&gt;,
  &quot;my_package.child1.Child1Class&quot;: &lt;class &quot;my_package.child1.Child1Class&quot;&gt;,
  &quot;my_package.child2.Child2Class&quot;: &lt;class &quot;my_package.child2.Child2Class&quot;&gt;,
  &quot;my_package.child3.Child3Class&quot;: &lt;class &quot;my_package.child3.Child3Class&quot;&gt;
}
</code></pre></div>
<p>This example assumes that the <code>BaseClass</code> is written in the file <code>my_package/base.py</code>
and <code>Child&lt;X&gt;Class</code> is written in the file <code>my_package/child&lt;X&gt;.py</code>.</p>
<p>Note that the base class and all its children classes have the attribute <code>inheritors</code> so you can
check the registered objects with any of these classes:</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">Child1Class</span><span class="o">.</span><span class="n">inheritors</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Child2Class</span><span class="o">.</span><span class="n">inheritors</span><span class="p">)</span>
</code></pre></div>
<p><em>Output:</em></p>
<div class="highlight"><pre><span></span><code>{
  &quot;my_package.base.BaseClass&quot;: &lt;class &quot;my_package.base.BaseClass&quot;&gt;,
  &quot;my_package.child1.Child1Class&quot;: &lt;class &quot;my_package.child1.Child1Class&quot;&gt;,
  &quot;my_package.child2.Child2Class&quot;: &lt;class &quot;my_package.child2.Child2Class&quot;&gt;,
  &quot;my_package.child3.Child3Class&quot;: &lt;class &quot;my_package.child3.Child3Class&quot;&gt;
}
{
  &quot;my_package.base.BaseClass&quot;: &lt;class &quot;my_package.base.BaseClass&quot;&gt;,
  &quot;my_package.child1.Child1Class&quot;: &lt;class &quot;my_package.child1.Child1Class&quot;&gt;,
  &quot;my_package.child2.Child2Class&quot;: &lt;class &quot;my_package.child2.Child2Class&quot;&gt;,
  &quot;my_package.child3.Child3Class&quot;: &lt;class &quot;my_package.child3.Child3Class&quot;&gt;
}
</code></pre></div>
<p>The key of each object is the full name of the object.
If you register two objects with the same full class name (package name + module name + class name),
only the last object will be registered.
It is the responsibility of the user to manage the object name to avoid duplicate.</p>
<p>If you have registered some functions, you should see them in the inheritors.
For example if you have registered the function <code>my_nodule</code> in the <code>BaseModule</code>, you should see
something like: <code>'my_package.nodule.my_nodule': &lt;function my_nodule at 0x...&gt;</code>.</p>
<h3 id="missing-objects">Missing objects<a class="headerlink" href="#missing-objects" title="Permanent link">&para;</a></h3>
<p>To be added to the factory, an object has to be loaded at least one time.
The objects are automatically registered when they are loaded the first time.
An object which is never loaded will never be registered.
If you do not see an object in the list of inheritors, it is probably because it was not loaded.
First, verify that the object inherits from the base factory class or the <code>register</code> function is
called.
Then, check if the python module with the object is loaded at least one time.</p>
<p>A solution to this problem is to write the child classes in the same python module that the base
factory class.
However, this solution is not always good or possible.
When there is a lot of objects, it is usually better to write them in several python modules.</p>
<p>Let's assume the following situation where each class is written in a different python module.
The package should have the following structure:</p>
<div class="highlight"><pre><span></span><code>my_package/
    __init__.py
    base.py
    child1.py
    child2.py
</code></pre></div>
<p>A solution is to import the child classes in the <code>__init__.py</code>. The file <code>__init__.py</code> should have
the following lines</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">my_package</span> <span class="kn">import</span> <span class="n">child1</span>
<span class="kn">from</span> <span class="nn">my_package</span> <span class="kn">import</span> <span class="n">child2</span>
</code></pre></div>
<p>Another solution is to use the <a href="#import-a-package">import package tool</a>.</p>
<h2 id="factory">Factory<a class="headerlink" href="#factory" title="Permanent link">&para;</a></h2>
<p>This section explains how to instantiate dynamically a class registered in a <code>AbstractFactory</code>.
One of the operation done by the <code>AbstractFactory</code> metaclass is to add the <code>factory</code> function to the
base factory class and all its child classes.
This function can instantiate any registered class given its configuration.
The signature of the<code>factory</code> function is:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">factory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">_target_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">_init_</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;__init__&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="o">...</span>
</code></pre></div>
<p>where <code>*args</code> and <code>**kwargs</code> are the parameters of the object to instantiate.
The input <code>_target_</code> is used to define the name of the object to instantiate and <code>_init_</code> indicates
the function used to create the object.
The following sections will explain the role of each parameter and how to use them.</p>
<h3 id="target-object">Target object<a class="headerlink" href="#target-object" title="Permanent link">&para;</a></h3>
<p>One of the key features of the <code>factory</code> function is that you can specify the name of the object
that you want to instantiate.
The <code>_target_</code> input is used to define the name of the object to instantiate.
For example if you want to create an  <code>Child1Class</code> object, you can write:</p>
<div class="highlight"><pre><span></span><code><span class="n">my_obj</span> <span class="o">=</span> <span class="n">BaseClass</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;my_package.child1.Child1Class&quot;</span><span class="p">)</span>
</code></pre></div>
<p>When you instantiate an object, you can also specify the arguments.
For example if you want to create a <code>Child2Class</code> object with 10 layers, you can write:</p>
<div class="highlight"><pre><span></span><code><span class="n">my_obj</span> <span class="o">=</span> <span class="n">BaseClass</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;my_package.child2.Child2Class&quot;</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<p>Sometimes it can be time consuming to write the full class name.
If the class name is unique, you can instantiate the object by only specifying the class name.
In the previous example, instead of the full class name (<code>my_package.child1.Child1Class</code>) you can
specify only the class name (<code>Child1Class</code>):</p>
<div class="highlight"><pre><span></span><code><span class="n">my_obj</span> <span class="o">=</span> <span class="n">BaseClass</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;Child1Class&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The second approach is easier to use, but it forces each class name to be unique.
Under the hood, the factory uses the <a href="../name_resolution/">name resolution mechanism</a> to find the
path where the class is.
If the class name is not unique, the name resolution mechanism will not be able to instantiate the
object because of the ambiguity.
If several classes have the same name, you need to specify the full name to break the ambiguity.</p>
<p>Let's imagine the case where there are two classes with the same name <code>Linear</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># Register the class Linear from PyTorch</span>
<span class="n">BaseModule</span><span class="o">.</span><span class="n">register_object</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">)</span>


<span class="c1"># Register another class Linear</span>
<span class="k">class</span> <span class="nc">Linear</span><span class="p">(</span><span class="n">BaseModule</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>
<p>There is no problem to register to class with the same class name because their full class name are
different (<code>torch.nn.modules.linear.Linear</code> vs <code>__main__.Linear</code>).
Please read the <a href="../name_resolution/">name resolution mechanism documentation</a> to learn why the real
full name of <code>torch.nn.linear.Linear</code> is <code>torch.nn.modules.linear.Linear</code>.
If you want to instantiate the <code>Linear</code> class from PyTorch, you will need to give the full class
name:</p>
<div class="highlight"><pre><span></span><code><span class="n">my_obj</span> <span class="o">=</span> <span class="n">BaseModule</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;torch.nn.Linear&quot;</span><span class="p">,</span> <span class="n">in_features</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
<p>If you want to instantiate the local <code>Linear</code> class, you will need to give the full class name:</p>
<div class="highlight"><pre><span></span><code><span class="n">my_obj</span> <span class="o">=</span> <span class="n">BaseModule</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;__main__.Linear&quot;</span><span class="p">,</span> <span class="n">in_features</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
<p>If you only specify <code>Linear</code>, the factory does not know what class you want to instantiate and will
raise an error.</p>
<div class="highlight"><pre><span></span><code><span class="n">my_obj</span> <span class="o">=</span> <span class="n">BaseModule</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="n">in_features</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="c1"># Raise the error: factory.error.UnregisteredObjectFactoryError: Unable to create the object Linear.</span>
<span class="c1"># Registered objects of BaseModule are {&#39;__main__.Linear&#39;, &#39;torch.nn.modules.linear.Linear&#39;}</span>
</code></pre></div>
<p>If several classes have the same name, the only solution is to specify the full class name.
Similarly to class, it is possible to specify the name of the function to call.
For example if you want to call the <code>my_nodule</code> function previously defined, you can write:</p>
<div class="highlight"><pre><span></span><code><span class="n">net</span> <span class="o">=</span> <span class="n">BaseModule</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;my_package.nodule.my_nodule&quot;</span><span class="p">,</span> <span class="n">input_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div>
<p>Finally, you can call the <code>factory</code> function with any class that inherits from the base factory
class:</p>
<div class="highlight"><pre><span></span><code><span class="n">my_obj</span> <span class="o">=</span> <span class="n">BaseClass</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;my_package.child1.Child1Class&quot;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">my_obj</span> <span class="o">=</span> <span class="n">Child1Class</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;my_package.child1.Child1Class&quot;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">my_obj</span> <span class="o">=</span> <span class="n">Child2Class</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;my_package.child1.Child1Class&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="initialization-function">Initialization function<a class="headerlink" href="#initialization-function" title="Permanent link">&para;</a></h3>
<p>By default, the <code>factory</code> function calls the function <code>__init__</code> of a class to create an object.
You can also create an object by using a class method.
You can use the keyword to <code>_init_</code> to specify the function to use to create the object.
The default value of this keyword is <code>"__init__"</code> so you do not need to change it if you call the
default constructor.
Note the initialization function input is only available for the classes.
This input is ignored when you call a function to instantiate an object.</p>
<p>Let's define a new class that has a class method to create an object:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># file: my_package/child4.py</span>
<span class="k">class</span> <span class="nc">Child4Class</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
</code></pre></div>
<p>Then, you can create an <code>Child4Class</code> object with the default method with the following command:</p>
<div class="highlight"><pre><span></span><code><span class="n">my_obj</span> <span class="o">=</span> <span class="n">BaseClass</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span>
    <span class="n">_target_</span><span class="o">=</span><span class="s2">&quot;my_package.child4.Child4Class&quot;</span><span class="p">,</span>
    <span class="n">_init_</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="instantiate-an-unregistered-object">Instantiate an unregistered object<a class="headerlink" href="#instantiate-an-unregistered-object" title="Permanent link">&para;</a></h3>
<p>The <code>AbstractFactory</code> metaclass provides some functionalities to dynamically instantiate an
unregistered object.
This feature is enabled by the <a href="../name_resolution/">name resolution mechanism</a>.
It is useful to instantiate an object which is not defined in a third party package.
For example if you want to load the class <code>torch.nn.GRU</code>, you can use the following line:</p>
<div class="highlight"><pre><span></span><code><span class="n">net</span> <span class="o">=</span> <span class="n">BaseClass</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;torch.nn.GRU&quot;</span><span class="p">,</span> <span class="n">input_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div>
<p>It is not necessary to register this class to instantiate it.
If the <code>_target_</code> value is a module path, the <code>factory</code> function tries to import it.
If the import is successful, the object is registered in the factory, so it is possible to reuse it
later.
This functionality is also useful when an object can be initialized by specifying several ways.
Due to some imports in the <code>__init__.py</code> of some packages, some objects have several module paths.
For example, a GRU object in PyTorch can be created by using the two approaches below:</p>
<div class="highlight"><pre><span></span><code><span class="n">net</span> <span class="o">=</span> <span class="n">BaseClass</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;torch.nn.GRU&quot;</span><span class="p">,</span> <span class="n">input_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">BaseClass</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;torch.nn.modules.rnn.GRU&quot;</span><span class="p">,</span> <span class="n">input_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div>
<p>Please read the <a href="../name_resolution/">name resolution mechanism</a> documentation to learn more about
it.</p>
<h2 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">&para;</a></h2>
<p>This section presents some useful tools for the <code>AbstractFactory</code> metaclass.</p>
<h3 id="register-all-the-child-classes">Register all the child classes<a class="headerlink" href="#register-all-the-child-classes" title="Permanent link">&para;</a></h3>
<p>In some cases, you may want to register a class and all its child classes.
Instead of doing manually, you can use the function <code>register_child_classes</code>.
This function will automatically register the given class and all its child classes.
It will find all the child classes and will add them to the registry.
It finds the child classes recursively, so it will also find the child classes of the child classes.</p>
<p>Let's imagine you have the following classes, and you want to register them to the base class
factory <code>BaseClass</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># file: my_package/my_module.py</span>
<span class="kn">from</span> <span class="nn">objectory.abstract_factory</span> <span class="kn">import</span> <span class="n">register_child_classes</span>


<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Foo</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">Baz</span><span class="p">(</span><span class="n">Foo</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">Bing</span><span class="p">(</span><span class="n">Bar</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="n">register_child_classes</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">,</span> <span class="n">Foo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">BaseClass</span><span class="o">.</span><span class="n">inheritors</span><span class="p">)</span>
</code></pre></div>
<p><em>Output</em>:</p>
<div class="highlight"><pre><span></span><code>{
  &#39;my_package.my_module.Foo&#39;,
  &#39;my_package.my_module.Baz&#39;,
  &#39;my_package.my_module.Bing&#39;,
  &#39;my_package.my_module.Bar&#39;
}
</code></pre></div>
<p>By default, the function <code>register_child_classes</code> ignores all the abstract classes because you
cannot instantiate them.
If you want to also register the abstract classes, you can use the
argument <code>ignore_abstract_class=False</code>.
The following example shows how to register all the <code>torch.nn.Module</code> including the abstract
classes.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">objectory.abstract_factory</span> <span class="kn">import</span> <span class="n">register_child_classes</span>

<span class="n">register_child_classes</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">ignore_abstract_class</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<h2 id="error-messages">Error messages<a class="headerlink" href="#error-messages" title="Permanent link">&para;</a></h2>
<p>This section lists some of the most frequent error messages and explain how to fix the error.
If you try to instantiate a class that is not registered (e.g. <code>Child3Class</code>), you will see the
following error message:</p>
<div class="highlight"><pre><span></span><code>objectory.abstract_factory.UnregisteredClassAbstractFactoryError: Unable to create
the class Child3Class. Verify that the class was added to the __init__.py file of its module.
Registered child classes of BaseClass are [&quot;child1class&quot;, &quot;child2class&quot;]
</code></pre></div>
<p>The error shows the list of classes that are registered
(<code>["my_package.base.BaseClass", "my_package.child1.Child1Class", "my_package.child2.Child2Class"]</code>
in this example).
If your class does not appear in that list, it is probably because your class was never imported and
registered.
Keep in mind that each class has to be loaded at least once to be registered.
The error <code>AbstractClassAbstractFactoryError</code> will be raised if you try to instantiate an abstract
class because an abstract class cannot be instantiated.</p>
<h2 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">&para;</a></h2>
<p>The  <code>AbstractFactory</code> metaclass adds some attributes and methods to the classes.
To avoid potential conflicts with the other classes, all the non-public attributes and functions
starts with <code>_abstractfactory_****</code> where <code>****</code> is the name of the attribute or the function.
As presented above, you cannot define the following methods:</p>
<ul>
<li><code>inheritors</code></li>
<li><code>factory</code></li>
<li><code>register_object</code></li>
<li><code>unregister</code></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 - present Thibaut Durand
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.expand"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"method": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>